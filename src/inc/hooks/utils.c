#include <linux/slab.h>
#include <asm/uaccess.h>

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////

#include "utils.h"

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////

char *duplicate_filename(const char __user *filename) {
    char *kernel_filename = kmalloc(4096, GFP_KERNEL);
    if (!kernel_filename)
        return NULL;

    if (strncpy_from_user(kernel_filename, filename, 4096) < 0) {
        kfree(kernel_filename);
        return NULL;
    }

    return kernel_filename;
}

// ////////////////////////////////////////////////////////////////////
// ////////////////////////////////////////////////////////////////////
